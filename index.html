<!DOCTYPE html>
<html>
<title>INFO 3300 - Project 1 </title>


<head>
<meta charset="UTF-8">
<script src="https://d3js.org/d3.v5.min.js"></script>
<link rel="stylesheet" href="./styles/all.css">
</head>

<body>
<h2>NYC Restaurant Guide: Health Score Comparison Visualizations</h2>

<div id="headline">INFO 3300 Project 1: Angela Chen (ac2689), Robert Kleyner (rsk227), Samantha Chu (sc2855)</div>
<section>
  <br>

  <div id="intro">
    We wanted to design a “user guide” to health-inspection conscious and popular restaurants in NYC. 
    In addition to providing a resource for people who want to choose a restaurant in one of our proposed categories, 
    we wanted to analyze and identify if there were any correlations between average price level 
    (based on Google Maps) vs. cuisine category (American, European, & Asian) , as well as the restaurant’s
     health score rated by the NYS Health Department and the number of Google reviews it has. 
  </div>
<br>

<p id="health_score_barplot"><h3> Visualization 1: The Correlation between Health Score and Restaurant's Average Price</h3>
  <div id="intro">
    In our first visualization, the bar chart is displaying the comparisons of the mean health score by cuisine 
    type and average price of each sample restaurant from Google Maps. Our rationale for comparing these variables 
    was based on the hypothesis that there might be a correlation between the mean health score and the average 
    price for each restaurant - the higher the score, the higher the average price of it. We also assume that the 
    taurants who receive higher health scores by NYS Health Department are more likely to set up higher average 
    prices as they regard themselves as “upscale” and “high-end service” restaurants.
  </div>
  <br>
<svg width="1000" height="500"></svg>


<script>

  // Referenced From: https://bl.ocks.org/Andrew-Reid/0aedd5f3fb8b099e3e10690bd38bd458


var svg = d3.select("svg")

var margin = {top: 20, right: 50, bottom: 60, left: 60};
var height = svg.attr("height");
var width = svg.attr("width");
var chartWidth = (svg.attr("width") - margin.left - margin.right);
var chartHeight = (svg.attr("height") - margin.top - margin.bottom);
var g = svg.append("g").attr("transform", "translate(" + margin.left + "," + margin.top + ")");

var y = d3.scaleBand()
    .rangeRound([0, chartHeight])
    .paddingInner(0.05)
    .align(0.1);

var x = d3.scaleLinear()
    .rangeRound([0, chartWidth]);

var z = d3.scaleOrdinal()
    .range(["#98abc5", "#8a89a6", "#7b6888", "#6b486b", "#a05d56", "#d0743c", "#ff8c00"]);

d3.csv("cuisine_barplot.csv").then(function(data) {

  var keys = data.columns.slice(1);

  y.domain(data.map(function(d) { return d.Price; }));
  x.domain([0, 150]).nice();
  z.domain(keys);

  g.append("g")
    .selectAll("g")
    .data(d3.stack().keys(keys)(data))
    .enter().append("g")
      .attr("fill", function(d) { return z(d.key); })
    .selectAll("rect")
    .data(function(d) { return d; })
    .enter().append("rect")
      .attr("y", function(d) { return y(d.data.Price); })
      .attr("x", function(d) { return x(d[0]); })
      .attr("width", function(d) { return x(d[1]) - x(d[0]); })
      .attr("height", y.bandwidth());

      // Referenced From: http://bl.ocks.org/mstanaland/6100713


  g.append("g")
      .attr("class", "axis")
      .attr("transform", "translate(0,0)")
      .call(d3.axisLeft(y));

  g.append("g")
      .attr("class", "axis")
    .attr("transform", "translate(0,"+(chartHeight+10)+")")
      .call(d3.axisBottom(x).ticks(null, "s"))
    .append("text")
      .attr("y", 5)
      .attr("x", x(x.ticks().pop()) + 0.5)
      .attr("dy", "0.32em")
      .attr("fill", "#000")
      .attr("font-weight", "bold")
      .attr("text-anchor", "start")
    .attr("transform", "translate("+ (-chartWidth) +",-10)");

  var legend = g.append("g")
      .attr("font-family", "sans-serif")
      .attr("font-size", 10)
      .attr("text-anchor", "end")
    .selectAll("g")
    .data(keys.slice().reverse())
    .enter().append("g")

   .attr("transform", function(d, i) { return "translate(-50," + (300 + i * 20) + ")"; });

  legend.append("rect")
      .attr("x", width - 20)
      .attr("width", 20)
      .attr("height", 20)
      .attr("fill", z);

  legend.append("text")
      .attr("x", width - 24)
      .attr("y", 9.5)
      .attr("dy", "0.32em")
      .text(function(d) { return d; });

 // Referenced From: https://bl.ocks.org/d3noob/23e42c8f67210ac6c678db2cd07a747e
  g.append("text")
      .attr("transform", "rotate(-90)")
      .attr("y", 0 - margin.left)
      .attr("x",0 - (chartHeight / 2))
      .attr("dy", "1em")
      .style("text-anchor", "middle")
      .text("Price");

  g.append("text")
      .attr("transform",
            "translate(" + (width/2) + " ," +
                           (chartHeight + 50) + ")")
      .style("text-anchor", "middle")
      .text("Average Health Score");

});
</script>
</p>



<p id="review_scatterplot"><h3> Visualization 2: The Correlation between Health Score and Number of Restaurant's Google Reviews </h4>

  <div id="intro">
    In our second visualization, the scatterplot is displaying a comparison between the number of google reviews 
    a restaurant has and its health score as rated by the New York State health department. Our rationale for 
    comparing these variables was based on the hypothesis that the the more reviewed on Google a restaurant was,
     there could be a correlation in that the health score may be skewed higher or lower. We assume that more
      prominent restaurants are likely to receive higher health scores by NYS Health Department, and therefore 
      they would get more Google reviews.
  </div>


<svg id="reviewplot" height="500" width="800">
  <text id="label" x="750" y="20" text-anchor="end" alignment-baseline="hanging"></text>
</svg>

   <div id="scatterLegend" class="legend"> </div>

<script>
// Referenced From 20.02.12.notes.htm - Found on 3300 Course Repository

d3.csv("Manhattan Restaurant.csv").then(function(data) {
  console.log(data);
  data.forEach( (d, i) => {
      d['Reviews'] = Number(d['Reviews']);
      d['Score'] = Number(d['Score']);
      d['Cuisine'] = String(d['Cuisine']);
    });


  const scoreMin = d3.min(data, (d) => {return d['Score'];} );
  const scoreMax = d3.max(data, (d) => {return d['Score'];} );
  const reviewsMin = d3.min(data, (d) => {return d['Reviews'];} );
  const reviewsMax = d3.max(data, (d) => {return d['Reviews'];} );

  console.log(scoreMin);
  console.log(scoreMax);

  console.log(reviewsMin);
  console.log(reviewsMax);


  const reviewplotsvg = d3.select("svg#reviewplot");
  const reviewplotwidth = reviewplotsvg.attr("width");
  const reviewplotheight = reviewplotsvg.attr("height");
  const reviewplotmargins = {"top": 50, "right": 50, "bottom": 50, "left": 50};
  const reviewchartWidth =reviewplotwidth - reviewplotmargins.left - reviewplotmargins.right;
  const reviewchartHeight = reviewplotheight - reviewplotmargins.top - reviewplotmargins.bottom;

  let annotations = reviewplotsvg.append("g").attr("id","annotations");

  let reviewplotgrid = reviewplotsvg.append("g").attr("id","points")
                  .attr("transform","translate("+reviewplotmargins.left+","+(reviewplotmargins.top)+")");

  const priceScale = d3.scaleLinear().domain([0, 8000]).range([0, reviewchartWidth]);
  const pointScale = d3.scaleLinear().domain([0, 120]).range([reviewchartHeight, 0]);

  const cuisineScale = d3.scaleOrdinal(d3.schemeCategory10);


let leftAxis = d3.axisLeft(pointScale)
                   .tickFormat(d3.format("~f"));

  let leftGridlines = d3.axisLeft(pointScale)
                        .tickSize(-reviewchartWidth-10)
                        .tickFormat("")


  annotations.append("g")
    .attr("class", "y axis")
    .attr("transform","translate("+(reviewplotmargins.left)+","+reviewplotmargins.top+")")
    .call(leftAxis)


  annotations.append("g")
    .attr("class", "y gridlines")
    .attr("transform","translate("+(reviewplotmargins.left)+","+reviewplotmargins.top+")")
    .call(leftGridlines);


  // Referenced From 02/17 Lecture
  let bottomAxis = d3.axisBottom(priceScale)


  let bottomGridlines = d3.axisBottom(priceScale)
                          .tickSize(-reviewchartHeight-10)
                          .tickFormat("")
  annotations.append("g")
    .attr("class", "x axis")
    .attr("transform","translate("+reviewplotmargins.left+","+(reviewchartHeight+reviewplotmargins.top)+")")
    .call(bottomAxis);
  annotations.append("g")
    .attr("class", "x gridlines")
    .attr("transform","translate("+reviewplotmargins.left+","+(reviewchartHeight+reviewplotmargins.top)+")")
    .call(bottomGridlines);

 let reviewplotscatter = reviewplotsvg.append("g")
                .attr("transform","translate("+(reviewplotmargins.left)+","+reviewplotmargins.top+")");

// Referenced From https://stackoverflow.com/questions/9450441/create-a-random-number-between-100-and-100-in-javascript


  // add circles
data.forEach( (d, i) => {

    let circle = reviewplotscatter.append("circle")
        .attr("cx", priceScale(d['Reviews'] ) )
        .attr("cy", pointScale(d['Score']  ))
        .attr("r", 4)
        .attr("opacity", 0.5)
        .attr("fill", cuisineScale(d['Cuisine']) )
        .attr("fill", 'grey' )
        .attr("Cuisine", d["Cuisine"])
        .attr("label", d["title"]);

  }  );

// Referenced From https://bl.ocks.org/d3noob/23e42c8f67210ac6c678db2cd07a747e

annotations.append("text")
      .attr("transform", "rotate(-90)")
      .attr("y", 0)
      .attr("x", 0 - (reviewplotheight / 2))
      .attr("dy", "1em")
      .style("text-anchor", "middle")
      .text("Health Score");


  annotations.append("text")
      .attr("transform",
            "translate(" + (reviewplotwidth/2) + " ," +
                           (reviewchartHeight + 90) + ")")
      .style("text-anchor", "middle")
      .text("Number of Google Reviews");

});

</script>
</p>

// Visualization 3: piechart
<p id="piechart">

  <script>
    var width =
  </script>

  </p>



</body>
</html>
